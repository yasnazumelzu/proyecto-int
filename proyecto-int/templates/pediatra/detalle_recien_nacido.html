{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle Reci√©n Nacido ‚Äî Pediatra</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #fff5f5;
      font-family: "Segoe UI", sans-serif;
    }
    .header-section {
      background-color: #e91e63;
      color: white;
      padding: 1.5rem;
      border-radius: 10px;
      margin-bottom: 2rem;
    }
    .btn-rol {
      background-color: #e91e63;
      color: white;
      border: none;
    }
    .btn-rol:hover {
      background-color: #c2185b;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container mt-4">
    <div class="header-section">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h3 class="mb-0">üë∂ Detalle del Reci√©n Nacido: {{ recien_nacido.nombre }}</h3>
          <p class="mb-0">Hospital Cl√≠nico Herminda Mart√≠n ‚Äî Chill√°n</p>
        </div>
        <div>
          {% if not alta %}
          <a href="{% url 'registrar_alta_recien_nacido_id' recien_nacido.id %}" class="btn btn-light me-2">üìã Registrar Alta</a>
          {% endif %}
          <a href="{% url 'lista_recien_nacidos' %}" class="btn btn-outline-light">Volver</a>
        </div>
      </div>
    </div>

    <!-- Informaci√≥n del Reci√©n Nacido -->
    <div class="card mb-4">
      <div class="card-header bg-danger text-white">
        <h5 class="mb-0">Informaci√≥n del Reci√©n Nacido</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Nombre:</strong> {{ recien_nacido.nombre }} {{ recien_nacido.apellido_paterno|default:'' }}</p>
            <p><strong>Fecha de Nacimiento:</strong> {{ recien_nacido.fecha_nacimiento|date:"d/m/Y" }}</p>
            {% if recien_nacido.hora_nacimiento %}
            <p><strong>Hora de Nacimiento:</strong> {{ recien_nacido.hora_nacimiento|time:"H:i" }}</p>
            {% endif %}
            <p><strong>Peso:</strong> {{ recien_nacido.peso }} g</p>
            <p><strong>Talla:</strong> {{ recien_nacido.talla|default:"-" }} cm</p>
            {% if recien_nacido.circunferencia_cefalica %}
            <p><strong>Circunferencia Cef√°lica:</strong> {{ recien_nacido.circunferencia_cefalica }} cm</p>
            {% endif %}
          </div>
          <div class="col-md-6">
            <p><strong>Sexo:</strong> {% if recien_nacido.sexo %}{{ recien_nacido.get_sexo_display }}{% else %}-{% endif %}</p>
            <p><strong>Tipo de Parto:</strong> {{ recien_nacido.get_tipo_parto_display|default:"-" }}</p>
            {% if recien_nacido.edad_gestacional_semanas %}
            <p><strong>Edad Gestacional:</strong> {{ recien_nacido.edad_gestacional_semanas }} semanas 
              {% if recien_nacido.edad_gestacional_dias %}{{ recien_nacido.edad_gestacional_dias }} d√≠as{% endif %}</p>
            {% endif %}
            <p><strong>APGAR 1 min:</strong> {{ recien_nacido.apgar_1min|default:"-" }}</p>
            <p><strong>APGAR 5 min:</strong> {{ recien_nacido.apgar_5min|default:"-" }}</p>
            {% if recien_nacido.diagnostico %}
            <p><strong>Diagn√≥stico:</strong> {{ recien_nacido.diagnostico }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Informaci√≥n de la Madre -->
    <div class="card mb-4">
      <div class="card-header bg-danger text-white">
        <h5 class="mb-0">Informaci√≥n de la Madre</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Nombre:</strong> {{ recien_nacido.paciente_madre.nombre }}</p>
            <p><strong>RUT:</strong> {{ recien_nacido.paciente_madre.rut }}</p>
            <p><strong>Edad:</strong> {{ recien_nacido.paciente_madre.edad }} a√±os</p>
          </div>
          <div class="col-md-6">
            {% if recien_nacido.paciente_madre.comuna %}
            <p><strong>Comuna:</strong> {{ recien_nacido.paciente_madre.comuna }}</p>
            {% endif %}
            {% if recien_nacido.paciente_madre.cesfam %}
            <p><strong>CESFAM:</strong> {{ recien_nacido.paciente_madre.cesfam }}</p>
            {% endif %}
            {% if recien_nacido.paciente_madre.vih_positivo %}
            <p><strong>VIH:</strong> <span class="badge bg-danger">Positivo</span></p>
            {% endif %}
            {% if recien_nacido.paciente_madre.hepatitis_b_resultado %}
            <p><strong>Hepatitis B:</strong> {{ recien_nacido.paciente_madre.hepatitis_b_resultado }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Informaci√≥n de Atenci√≥n Inmediata -->
    <div class="card mb-4">
      <div class="card-header bg-danger text-white">
        <h5 class="mb-0">Atenci√≥n Inmediata</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Reanimaci√≥n B√°sica:</strong> {% if recien_nacido.reanimacion_basica %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Reanimaci√≥n Avanzada:</strong> {% if recien_nacido.reanimacion_avanzada %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Profilaxis Ocular:</strong> {% if recien_nacido.profilaxis_ocular %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Vacuna Hepatitis B:</strong> {% if recien_nacido.vacuna_hepatitis_b %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Vacuna BCG:</strong> {% if recien_nacido.vacuna_bcg %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
          </div>
          <div class="col-md-6">
            <p><strong>Apego Canguro:</strong> {% if recien_nacido.apego_canguro %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Lactancia antes 60 min:</strong> {% if recien_nacido.lactancia_antes_60min %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Clampado Tard√≠o:</strong> {% if recien_nacido.clampado_tardio %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            <p><strong>Alojamiento Conjunto:</strong> {% if recien_nacido.alojamiento_conjunto_puerperio %}‚úì S√≠{% else %}‚úó No{% endif %}</p>
            {% if recien_nacido.malformacion_congenita %}
            <p><strong>Malformaci√≥n Cong√©nita:</strong> <span class="badge bg-warning">S√≠</span></p>
            <p><strong>Descripci√≥n:</strong> {{ recien_nacido.descripcion_malformacion|default:"-" }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <!-- Informaci√≥n de Alta -->
    {% if alta %}
    <div class="card">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0">Alta Registrada</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <p><strong>Fecha de Alta:</strong> {{ alta.fecha_alta|date:"d/m/Y H:i" }}</p>
            <p><strong>Tipo de Alta:</strong> {{ alta.get_tipo_alta_display }}</p>
            <p><strong>Condici√≥n al Alta:</strong> {{ alta.get_condicion_alta_display }}</p>
            {% if alta.fecha_egreso %}
            <p><strong>Fecha de Egreso:</strong> {{ alta.fecha_egreso|date:"d/m/Y H:i" }}</p>
            {% endif %}
          </div>
          <div class="col-md-6">
            <p><strong>Diagn√≥stico Final:</strong> {{ alta.diagnostico_final }}</p>
            {% if alta.peso_alta %}
            <p><strong>Peso al Alta:</strong> {{ alta.peso_alta }} g</p>
            {% endif %}
            {% if alta.requiere_seguimiento %}
            <p><strong>Requiere Seguimiento:</strong> <span class="badge bg-warning">S√≠</span></p>
            {% if alta.fecha_control_proximo %}
            <p><strong>Pr√≥ximo Control:</strong> {{ alta.fecha_control_proximo|date:"d/m/Y" }}</p>
            {% endif %}
            {% endif %}
          </div>
        </div>
        {% if alta.indicaciones_alta %}
        <div class="mt-3">
          <p><strong>Indicaciones al Alta:</strong></p>
          <p>{{ alta.indicaciones_alta }}</p>
        </div>
        {% endif %}
        <a href="{% url 'lista_altas_recien_nacidos' %}" class="btn btn-outline-primary mt-3">Ver Detalle Completo del Alta</a>
      </div>
    </div>
    {% else %}
    <div class="alert alert-warning">
      <strong>‚ö†Ô∏è Sin Alta Registrada</strong> - Este reci√©n nacido a√∫n no tiene un alta m√©dica registrada.
      <a href="{% url 'registrar_alta_recien_nacido_id' recien_nacido.id %}" class="alert-link">Registrar alta ahora</a>
    </div>
    {% endif %}
  </div>
</body>
</html>

